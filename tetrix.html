<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tetris Game</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
  <style>
    #tetris {
      display: grid;
      grid-template-columns: repeat(10, 2rem);
      grid-template-rows: repeat(20, 2rem);
      gap: 1.5px;
      background-color: #1e293b;
      border: 3px solid #334155;
      border-radius: 0.5rem;
      width: max-content;
      margin: 0 auto;
      user-select: none;
    }
    .cell {
      width: 2rem;
      height: 2rem;
      background-color: #0f172a;
      border-radius: 0.25rem;
      box-sizing: border-box;
      transition: background-color 0.2s ease;
    }
    .I { background-color: #06b6d4; box-shadow: 0 0 6px #06b6d4; }
    .J { background-color: #2563eb; box-shadow: 0 0 6px #2563eb; }
    .L { background-color: #f97316; box-shadow: 0 0 6px #f97316; }
    .O { background-color: #eab308; box-shadow: 0 0 6px #eab308; }
    .S { background-color: #22c55e; box-shadow: 0 0 6px #22c55e; }
    .T { background-color: #a855f7; box-shadow: 0 0 6px #a855f7; }
    .Z { background-color: #ef4444; box-shadow: 0 0 6px #ef4444; }

    #next-piece {
      width: 8rem;
      height: 8rem;
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      grid-template-rows: repeat(4, 1fr);
      gap: 0.2rem;
      background: #0f172a;
      border-radius: 0.5rem;
      margin: 0 auto;
      box-shadow: 0 0 10px #a855f7;
    }

    #start-button-mobile {
      display: none;
    }

    @media(max-width: 768px){
      #start-button-mobile { display: block; margin: 1rem auto; }
      #start-button { display: none; }
      #next-piece { width: 6rem; height: 6rem; }
      .cell { width: 1.5rem; height: 1.5rem; }
    }
  </style>
</head>
<body class="bg-slate-900 text-slate-100 flex flex-col min-h-screen">
  <header class="p-4 text-center">
    <h1 class="text-3xl font-extrabold">Tetris Game</h1>
  </header>

  <main class="flex flex-col items-center flex-grow px-4 pb-12">
    <div id="tetris" aria-label="Tetris game board" role="grid" tabindex="0"></div>
    <div id="next-piece" aria-label="Next Tetris piece preview"></div>

    <!-- Start / Restart buttons -->
    <button id="start-button" class="w-64 py-2 mt-4 bg-indigo-600 hover:bg-indigo-700 active:bg-indigo-800 rounded-lg font-semibold text-lg shadow-lg">
      Start / Restart
    </button>
    <button id="start-button-mobile" class="w-64 py-2 bg-indigo-600 hover:bg-indigo-700 active:bg-indigo-800 rounded-lg font-semibold text-lg shadow-lg">
      Start / Restart
    </button>
  </main>

  <footer class="text-center p-4 text-slate-500 text-sm">
    &copy; 2024 Tetris by Tailwind Expert
  </footer>

  <script>
    const COLS = 10, ROWS = 20;
    const TETROMINOS = {
      I: [[[1,1,1,1]],[[1],[1],[1],[1]]],
      J: [[[1,0,0],[1,1,1]],[[1,1],[1,0],[1,0]],[[1,1,1],[0,0,1]],[[0,1],[0,1],[1,1]]],
      L: [[[0,0,1],[1,1,1]],[[1,0],[1,0],[1,1]],[[1,1,1],[1,0,0]],[[1,1],[0,1],[0,1]]],
      O: [[[1,1],[1,1]]],
      S: [[[0,1,1],[1,1,0]],[[1,0],[1,1],[0,1]]],
      T: [[[0,1,0],[1,1,1]],[[1,0],[1,1],[1,0]],[[1,1,1],[0,1,0]],[[0,1],[1,1],[0,1]]],
      Z: [[[1,1,0],[0,1,1]],[[0,1],[1,1],[1,0]]]
    };
    const COLORS = { I:"I", J:"J", L:"L", O:"O", S:"S", T:"T", Z:"Z" };

    let board=[], currentPiece=null, currentX=0, currentY=0, currentRotation=0;
    let score=0, level=1, linesCleared=0, dropInterval=1000, dropTimer=null, isGameOver=false;
    let nextPiece=null;

    const tetrisEl = document.getElementById("tetris");
    const nextPieceEl = document.getElementById("next-piece");
    const startButton = document.getElementById("start-button");
    const startButtonMobile = document.getElementById("start-button-mobile");

    function initBoard(){
      board=[]; tetrisEl.innerHTML="";
      for(let r=0;r<ROWS;r++){
        board[r]=[];
        for(let c=0;c<COLS;c++){
          board[r][c]="";
          const cell=document.createElement("div");
          cell.classList.add("cell");
          tetrisEl.appendChild(cell);
        }
      }
    }

    function draw(){
      for(let r=0;r<ROWS;r++){
        for(let c=0;c<COLS;c++){
          const cellIndex=r*COLS+c;
          const cell=tetrisEl.children[cellIndex];
          cell.className="cell";
          if(board[r][c]) cell.classList.add(board[r][c]);
        }
      }
      if(currentPiece){
        const shape=TETROMINOS[currentPiece][currentRotation];
        for(let r=0;r<shape.length;r++){
          for(let c=0;c<shape[r].length;c++){
            if(shape[r][c]){
              const x=currentX+c;
              const y=currentY+r;
              if(y>=0 && y<ROWS && x>=0 && x<COLS){
                const cellIndex=y*COLS+x;
                tetrisEl.children[cellIndex].classList.add(COLORS[currentPiece]);
              }
            }
          }
        }
      }
    }

    function getCurrentShape(){ return TETROMINOS[currentPiece][currentRotation]; }
    function isValidPosition(x,y,rotation){
      const shape=TETROMINOS[currentPiece][rotation];
      for(let r=0;r<shape.length;r++){
        for(let c=0;c<shape[r].length;c++){
          if(shape[r][c]){
            const newX=x+c, newY=y+r;
            if(newX<0||newX>=COLS||newY>=ROWS||(newY>=0 && board[newY][newX])) return false;
          }
        }
      }
      return true;
    }

    function placePiece(){
      const shape=getCurrentShape();
      for(let r=0;r<shape.length;r++){
        for(let c=0;c<shape[r].length;c++){
          if(shape[r][c]){
            const x=currentX+c, y=currentY+r;
            if(y>=0 && y<ROWS && x>=0 && x<COLS) board[y][x]=COLORS[currentPiece];
          }
        }
      }
    }

    function clearLines(){
      let lines=0;
      for(let r=ROWS-1;r>=0;r--){
        if(board[r].every(cell=>cell!=="")){
          board.splice(r,1);
          board.unshift(new Array(COLS).fill(""));
          lines++; r++;
        }
      }
      if(lines>0){
        linesCleared+=lines;
        score+=[0,40,100,300,1200][lines]*level;
        level=Math.floor(linesCleared/10)+1;
        dropInterval=Math.max(100,1000-(level-1)*100);
        resetDropTimer();
      }
    }

    function spawnPiece(){
      currentPiece=nextPiece || Object.keys(TETROMINOS)[Math.floor(Math.random()*7)];
      nextPiece=Object.keys(TETROMINOS)[Math.floor(Math.random()*7)];
      currentX=Math.floor(COLS/2)-1; currentY=-1; currentRotation=0;
      drawNextPiece();
      if(!isValidPosition(currentX,currentY,currentRotation)) gameOver();
    }

    function move(dx,dy){
      if(isValidPosition(currentX+dx,currentY+dy,currentRotation)){
        currentX+=dx; currentY+=dy; draw();
        return true;
      }
      return false;
    }

    function rotate(){
      const newRotation=(currentRotation+1)%TETROMINOS[currentPiece].length;
      if(isValidPosition(currentX,currentY,newRotation)){
        currentRotation=newRotation;
        draw();
      }
    }

    function drop(){
      if(!move(0,1)){
        placePiece();
        clearLines();
        spawnPiece();
      }
    }

    function gameOver(){ isGameOver=true; clearInterval(dropTimer); alert("Game Over! Score: "+score); }

    function resetDropTimer(){
      if(dropTimer) clearInterval(dropTimer);
      dropTimer=setInterval(drop,dropInterval);
    }

    function startGame(){
      isGameOver=false; score=0; linesCleared=0; level=1; dropInterval=1000;
      initBoard();
      spawnPiece();
      resetDropTimer();
      draw();
    }

    function drawNextPiece(){
      nextPieceEl.innerHTML="";
      const shape=TETROMINOS[nextPiece][0];
      for(let r=0;r<4;r++){
        for(let c=0;c<4;c++){
          const cell=document.createElement("div");
          cell.classList.add("cell");
          if(shape[r] && shape[r][c]) cell.classList.add(COLORS[nextPiece]);
          nextPieceEl.appendChild(cell);
        }
      }
    }

    document.addEventListener("keydown",e=>{
      if(isGameOver) return;
      if(e.key==="ArrowLeft") move(-1,0);
      else if(e.key==="ArrowRight") move(1,0);
      else if(e.key==="ArrowDown") move(0,1);
      else if(e.key==="ArrowUp") rotate();
      else if(e.key===" ") drop();
    });

    [startButton, startButtonMobile].forEach(btn=>{
      if(btn) btn.addEventListener("click", startGame);
    });

    initBoard();
  </script>
</body>
</html>
